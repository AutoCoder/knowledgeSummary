**SimHash**

simhash是一种能计算文档相似度的hash算法。通过simhash能将一篇文章映射成64bit，再比较两篇文章的64bit的海明距离，就能知道文章的相似程序。若两篇文章的海明距离<=3，可认为这两篇文章很相近，可认为它们是重复的文章。 

**计算方法**

simhash算法分为5个步骤：分词、hash、加权、合并、降维，具体过程如下所述： 

分词

- 给定一段语句，进行分词，得到有效的特征向量，然后为每一个特征向量设置1-5等5个级别的权重（如果是给定一个文本，那么特征向量可以是文本中 的词，其权重可以是这个词出现的次数）。例如给定一段语句：“CSDN博客结构之法算法之道的作者July”，分词后为：“CSDN 博客 结构 之 法 算法 之 道 的 作者 July”，然后为每个特征向量赋予权值：CSDN(4) 博客(5) 结构(3) 之(1) 法(2) 算法(3) 之(1) 道(2) 的(1) 作者(5) July(5)，其中括号里的数字代表这个单词在整条语句中的重要程度，数字越大代表越重要。

- hash

  通过hash函数计算各个特征向量的hash值，hash值为二进制数01组成的n-bit签名。比如“CSDN”的hash值Hash(CSDN)为100101，“博客”的hash值Hash(博客)为“101011”。就这样，字符串就变成了一系列数字。

- 合并 

  将上述各个特征向量的加权结果累加，变成只有一个序列串。拿前两个特征向量举例，例如“CSDN”的“4 -4 -4 4 -4 4”和“博客”的“5 -5 5 -5 5 5”进行累加，得到“4+5 -4+-5 -4+5 4+-5 -4+5 4+5”，得到“9 -9 1 -1 1”。

- 降维 

  对于n-bit签名的累加结果，如果大于0则置1，否则置0，从而得到该语句的simhash值，最后我们便可以根据不同语句simhash的海 明距离来判断它们的相似度。例如把上面计算出来的“9 -9 1 -1 1 9”降维（某位大于0记为1，小于0记为0），得到的01串为：“1 0 1 0 1 1”，从而形成它们的simhash签名。

------

**海明距离(HammingDistance)**

计算汉明距离的一种方法，就是对两个位串进行异或（xor）运算，并计算出异或运算结果中1的个数。例如110和011这两个位串，对它们进行异或运算，其结果是：

110 ^ 011=101

异或结果中含有两个1，因此110和011之间的汉明距离就等于2。

------

**余弦相似度**

余弦相似度衡量的是2个向量间的夹角大小，通过夹角的余弦值表示结果，因此2个向量的余弦相似度为： 

$$\displaystyle \cos\theta=\frac{A\cdot B}{||A|| *||B||}\tag{1}$$

余弦相似度的取值为[-1,1]，值越大表示越相似。 

点积： $$A\cdot B$$,   例子： $$a = [a_{1}, a_{2} ... a_{n}]$$, $$b = [b_{1}, b_{2} ... b_{n}]$$,   $$a \cdot b = a_{1} * b_{1} + ... +  a_{n} * b_{n}$$

模： 向量 A 的大小，也就是向量 A 的长度（或称模）。 例子： 向量 (x,y,z) 的模 $$\sqrt { x^2 + y^2 + z^2 }$$



